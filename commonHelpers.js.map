{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nexport default async function fetchURL(userInput, countPage, per_page) {\n  var API_KEY = '44071670-df551d8a467c5c77b993c0d31';\n  const response = await axios.get(`https://pixabay.com/api/`, {\n    params: {\n      key: API_KEY,\n      q: userInput,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: countPage,\n      per_page: per_page,\n    },\n  });\n  return response.data;\n}\n// const searchParams = new URLSearchParams({\n//   key: API_KEY,\n//   q: userInput,\n//   image_type: 'photo',\n//   orientation: 'horizontal',\n//   safesearch: true,\n//   per_page: 15,\n// });\n// const response = await axios.get(`https://pixabay.com/api/?${searchParams}.`);\n","export default function createGallery(images) {\n  const gallery = document.querySelector('.gallery');\n\n  const imgHtmlElems = images\n    .map(elem => {\n      return `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${elem.largeImageURL}\">\n            <img class=\"gallery-img\" src=\"${elem.webformatURL}\" alt=\"${elem.tags}\">\n          </a>\n          <ul class=\"info\">\n            <li class=\"info-item\">\n              <h2 class=\"info-title\">Likes</h2>\n              <p class=\"info-value\">${elem.likes}</p>\n            </li>\n            <li class=\"info-item\">\n              <h2 class=\"info-title\">Views</h2>\n              <p class=\"info-value\">${elem.views}</p>\n            </li>\n            <li class=\"info-item\">\n              <h2 class=\"info-title\">Comments</h2>\n              <p class=\"info-value\">${elem.comments}</p>\n            </li>\n            <li class=\"info-item\">\n              <h2 class=\"info-title\">Downloads</h2>\n              <p class=\"info-value\">${elem.downloads}</p>\n            </li>\n          </ul>\n        </li>`;\n    })\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', imgHtmlElems);\n}\n","import fetchURL from './js/pixabay-api';\nimport createGallery from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('form');\nconst imageSearchInput = document.querySelector('input');\nlet currentValueImageSearchInput;\nconst gallerySimpleLightbox = new SimpleLightbox('.gallery a');\nconst loader = document.querySelector('.loader');\nconst gallery = document.querySelector('.gallery');\nconst fetchMorePostsBtn = document.querySelector('.fetchMorePostsBtn');\n\nlet page = 1;\nconst per_page = 15;\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  if (\n    currentValueImageSearchInput === imageSearchInput.value ||\n    imageSearchInput.value === ''\n  ) {\n    iziToastInfo('Please, enter another request');\n    page = 1;\n    return;\n  }\n\n  gallery.innerHTML = '';\n  hideFetchMorePostsBtn();\n  showLoadingIndicator();\n  currentValueImageSearchInput = imageSearchInput.value;\n\n  try {\n    let values = await fetchURL(imageSearchInput.value, page, per_page);\n\n    hideLoadingIndicator();\n    if (values.totalHits < per_page) {\n      iziToastInfo(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      return;\n    }\n    createGallery(values.hits);\n    gallerySimpleLightbox.refresh();\n\n    scrollToLastAddedCard();\n\n    checkValueCounts(values.hits.length, values.totalHits);\n  } catch (er) {\n    console.log(er);\n  }\n});\n\nfetchMorePostsBtn.addEventListener('click', () => {\n  fetchURL(imageSearchInput.value, page, per_page)\n    .then(response => {\n      createGallery(response.hits);\n      gallerySimpleLightbox.refresh();\n      scrollToLastAddedCard();\n      checkValueCounts(response.hits.length, response.totalHits);\n    })\n    .catch(er => {\n      console.log(er);\n    });\n});\nfunction scrollToLastAddedCard() {\n  const lastCard = gallery.lastElementChild;\n  if (lastCard) {\n    const rect = lastCard.getBoundingClientRect();\n\n    window.scrollBy({\n      top: rect.width * 2,\n      behavior: 'smooth',\n    });\n  }\n}\n\nfunction checkValueCounts(values, totalValues) {\n  if (values >= per_page && totalValues > gallery.childElementCount) {\n    page += 1;\n    showFetchMorePostsBtn();\n  } else {\n    iziToastInfo(\"We're sorry, but you've reached the end of search results.\");\n    hideFetchMorePostsBtn();\n  }\n}\n\nfunction iziToastInfo(message) {\n  iziToast.info({\n    timeout: 2000,\n    position: 'topRight',\n    message: `${message}`,\n  });\n}\n\nfunction showLoadingIndicator() {\n  loader.style.display = 'block';\n}\n\nfunction hideLoadingIndicator() {\n  loader.style.display = 'none';\n}\nfunction showFetchMorePostsBtn() {\n  fetchMorePostsBtn.style.display = 'block';\n}\nfunction hideFetchMorePostsBtn() {\n  fetchMorePostsBtn.style.display = 'none';\n}\n"],"names":["fetchURL","userInput","countPage","per_page","API_KEY","axios","createGallery","images","gallery","imgHtmlElems","elem","form","imageSearchInput","currentValueImageSearchInput","gallerySimpleLightbox","SimpleLightbox","loader","fetchMorePostsBtn","page","event","iziToastInfo","hideFetchMorePostsBtn","showLoadingIndicator","values","hideLoadingIndicator","scrollToLastAddedCard","checkValueCounts","er","response","lastCard","rect","totalValues","showFetchMorePostsBtn","message","iziToast"],"mappings":"+vBACe,eAAeA,EAASC,EAAWC,EAAWC,EAAU,CACrE,IAAIC,EAAU,qCAYd,OAXiB,MAAMC,EAAM,IAAI,2BAA4B,CAC3D,OAAQ,CACN,IAAKD,EACL,EAAGH,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAUC,CACX,CACL,CAAG,GACe,IAClB,CCfe,SAASG,EAAcC,EAAQ,CAC5C,MAAMC,EAAU,SAAS,cAAc,UAAU,EAE3CC,EAAeF,EAClB,IAAIG,GACI;AAAA;AAAA,0CAE6BA,EAAK,aAAa;AAAA,4CAChBA,EAAK,YAAY,UAAUA,EAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,sCAK1CA,EAAK,KAAK;AAAA;AAAA;AAAA;AAAA,sCAIVA,EAAK,KAAK;AAAA;AAAA;AAAA;AAAA,sCAIVA,EAAK,QAAQ;AAAA;AAAA;AAAA;AAAA,sCAIbA,EAAK,SAAS;AAAA;AAAA;AAAA,cAI/C,EACA,KAAK,EAAE,EACVF,EAAQ,mBAAmB,YAAaC,CAAY,CACtD,CCzBA,MAAME,EAAO,SAAS,cAAc,MAAM,EACpCC,EAAmB,SAAS,cAAc,OAAO,EACvD,IAAIC,EACJ,MAAMC,EAAwB,IAAIC,EAAe,YAAY,EACvDC,EAAS,SAAS,cAAc,SAAS,EACzCR,EAAU,SAAS,cAAc,UAAU,EAC3CS,EAAoB,SAAS,cAAc,oBAAoB,EAErE,IAAIC,EAAO,EACX,MAAMf,EAAW,GAEjBQ,EAAK,iBAAiB,SAAU,MAAMQ,GAAS,CAE7C,GADAA,EAAM,eAAc,EAElBN,IAAiCD,EAAiB,OAClDA,EAAiB,QAAU,GAC3B,CACAQ,EAAa,+BAA+B,EAC5CF,EAAO,EACP,MACD,CAEDV,EAAQ,UAAY,GACpBa,IACAC,IACAT,EAA+BD,EAAiB,MAEhD,GAAI,CACF,IAAIW,EAAS,MAAMvB,EAASY,EAAiB,MAAOM,EAAMf,CAAQ,EAGlE,GADAqB,IACID,EAAO,UAAYpB,EAAU,CAC/BiB,EACE,0EACR,EACM,MACD,CACDd,EAAciB,EAAO,IAAI,EACzBT,EAAsB,QAAO,EAE7BW,IAEAC,EAAiBH,EAAO,KAAK,OAAQA,EAAO,SAAS,CACtD,OAAQI,EAAI,CACX,QAAQ,IAAIA,CAAE,CACf,CACH,CAAC,EAEDV,EAAkB,iBAAiB,QAAS,IAAM,CAChDjB,EAASY,EAAiB,MAAOM,EAAMf,CAAQ,EAC5C,KAAKyB,GAAY,CAChBtB,EAAcsB,EAAS,IAAI,EAC3Bd,EAAsB,QAAO,EAC7BW,IACAC,EAAiBE,EAAS,KAAK,OAAQA,EAAS,SAAS,CAC/D,CAAK,EACA,MAAMD,GAAM,CACX,QAAQ,IAAIA,CAAE,CACpB,CAAK,CACL,CAAC,EACD,SAASF,GAAwB,CAC/B,MAAMI,EAAWrB,EAAQ,iBACzB,GAAIqB,EAAU,CACZ,MAAMC,EAAOD,EAAS,wBAEtB,OAAO,SAAS,CACd,IAAKC,EAAK,MAAQ,EAClB,SAAU,QAChB,CAAK,CACF,CACH,CAEA,SAASJ,EAAiBH,EAAQQ,EAAa,CACzCR,GAAUpB,GAAY4B,EAAcvB,EAAQ,mBAC9CU,GAAQ,EACRc,MAEAZ,EAAa,4DAA4D,EACzEC,IAEJ,CAEA,SAASD,EAAaa,EAAS,CAC7BC,EAAS,KAAK,CACZ,QAAS,IACT,SAAU,WACV,QAAS,GAAGD,CAAO,EACvB,CAAG,CACH,CAEA,SAASX,GAAuB,CAC9BN,EAAO,MAAM,QAAU,OACzB,CAEA,SAASQ,GAAuB,CAC9BR,EAAO,MAAM,QAAU,MACzB,CACA,SAASgB,GAAwB,CAC/Bf,EAAkB,MAAM,QAAU,OACpC,CACA,SAASI,GAAwB,CAC/BJ,EAAkB,MAAM,QAAU,MACpC"}